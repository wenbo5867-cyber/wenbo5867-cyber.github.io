<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>çƒ­åŠ›å›¾åˆ†æ - å®éªŒå®¤</title>
  <link rel="stylesheet" href="CSS/001.css">
  <link rel="stylesheet" href="CSS/HeatMap.css">
</head>
<body>
  <header class="main-header">
    <div class="header-container">
      <nav class="main-navigation">
        <ul class="nav-menu">
          <li class="nav-item" id="data-processing">
            <a href="#" class="nav-link">
              <span class="icon">ğŸ“¦</span>
              <span class="text">æ•°æ®å¤„ç†</span>
            </a>
          </li>
          <li class="nav-item active" id="data-analysis">
            <a href="#" class="nav-link">
              <span class="icon">ğŸ“ˆ</span>
              <span class="text">æ•°æ®åˆ†æ</span>
            </a>
          </li>
        </ul>
      </nav>
    </div>
  </header>
  
  <!-- ä¸‹æ‹‰é€‰é¡¹æ¡† -->
  <div class="dropdown-container">
    <div class="dropdown-menu" id="processing-dropdown">
      <div class="dropdown-item">ä¸Šä¼ è§†é¢‘</div>
      <div class="dropdown-item">å‰ªè¾‘è§†é¢‘</div>
    </div>
    
    <div class="dropdown-menu" id="analysis-dropdown">
      <div class="dropdown-item">è§†é¢‘è¯†åˆ«</div>
      <div class="dropdown-item">æ¯ä¸ªIDç‚¹åˆ†æç»“æœ</div>
      <div class="dropdown-item">æ‰€æœ‰IDç‚¹åˆ†æç»“æœ</div>
      <div class="dropdown-item">çƒ­åŠ›å›¾</div>
    </div>
  </div>
  
  <main class="main-content">
    <section class="content-section">
      <h2>çƒ­åŠ›å›¾åˆ†æ</h2>
      
      <!-- ä¸Šä¼ ExcelåŒºåŸŸ -->
      <div class="upload-section">
        <div class="upload-area" id="uploadArea">
          <div class="upload-icon">ğŸ“Š</div>
          <p>ç‚¹å‡»é€‰æ‹©å¤„ç†åçš„Excelæ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„</p>
          <p class="file-info">æ”¯æŒXLSXã€CSVç­‰æ ¼å¼</p>
          <input type="file" id="fileInput" accept=".xlsx,.xls,.csv" style="display: none;">
        </div>
        
        <button class="upload-btn" id="selectFileBtn">é€‰æ‹©å¤„ç†åçš„Excelè¡¨æ ¼</button>
      </div>
      
      <!-- çŠ¶æ€æ˜¾ç¤ºåŒºåŸŸ -->
      <div class="status-section">
        <div class="upload-status" id="uploadStatus">
          <p>ç­‰å¾…ä¸Šä¼ ...</p>
        </div>
      </div>
      
      <!-- æ“ä½œæŒ‰é’®åŒºåŸŸ -->
      <div class="action-section">
        <button class="download-btn" id="downloadBtn" disabled>ä¸‹è½½</button>
      </div>
      
      <!-- çƒ­åŠ›å›¾å±•ç¤ºåŒºåŸŸ -->
      <div class="heatmap-container">
        <div class="heatmap-placeholder">
          <img src="https://picsum.photos/800/500?random=1" alt="çƒ­åŠ›å›¾">
          <p>çƒ­åŠ›å›¾å±•ç¤ºåŒºåŸŸ</p>
        </div>
      </div>
      
      
    </section>
  </main>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // å¯¼èˆªèœå•åŠŸèƒ½
      const dataProcessing = document.getElementById('data-processing');
      const dataAnalysis = document.getElementById('data-analysis');
      const processingDropdown = document.getElementById('processing-dropdown');
      const analysisDropdown = document.getElementById('analysis-dropdown');
      
      function hideAllDropdowns() {
        processingDropdown.style.display = 'none';
        analysisDropdown.style.display = 'none';
      }
      
      dataProcessing.addEventListener('click', function(e) {
        e.preventDefault();
        hideAllDropdowns();
        processingDropdown.style.display = 'block';
      });
      
      dataAnalysis.addEventListener('click', function(e) {
        e.preventDefault();
        hideAllDropdowns();
        analysisDropdown.style.display = 'block';
      });
      
      document.addEventListener('click', function(e) {
        if (!dataProcessing.contains(e.target) && 
            !dataAnalysis.contains(e.target) &&
            !processingDropdown.contains(e.target) &&
            !analysisDropdown.contains(e.target)) {
          hideAllDropdowns();
        }
      });
      
      // ä¸‹æ‹‰é¡¹ç‚¹å‡»äº‹ä»¶
      document.querySelectorAll('.dropdown-item').forEach(item => {
        item.addEventListener('click', function() {
          const text = this.textContent;
          if (text === 'ä¸Šä¼ è§†é¢‘') {
            window.location.href = 'OpenVideo.html';
          } else if (text === 'å‰ªè¾‘è§†é¢‘') {
            window.location.href = 'ClipVideo.html';
          } else if (text === 'è§†é¢‘è¯†åˆ«') {
            window.location.href = 'VideoRecognition.html';
          } else if (text === 'æ¯ä¸ªIDç‚¹åˆ†æç»“æœ') {
            window.location.href = 'IDPointAnalysis.html';
          } else if (text === 'æ‰€æœ‰IDç‚¹åˆ†æç»“æœ') {
            window.location.href = 'AllIDPointAnalysis.html';
          } else if (text === 'çƒ­åŠ›å›¾') {
            window.location.href = 'HeatMap.html';
          } else {
            alert(`ä½ é€‰æ‹©äº†: ${text}`);
            hideAllDropdowns();
          }
        });
      });
      
      // é¡µé¢ç‰¹å®šåŠŸèƒ½
      const uploadArea = document.getElementById('uploadArea');
      const fileInput = document.getElementById('fileInput');
      const selectFileBtn = document.getElementById('selectFileBtn');
      const uploadStatus = document.getElementById('uploadStatus');
      const downloadBtn = document.getElementById('downloadBtn');
      
      let uploadedFile = null;
      
      // ç‚¹å‡»é€‰æ‹©æ–‡ä»¶æŒ‰é’®
      selectFileBtn.addEventListener('click', function() {
        fileInput.click();
      });
      
      // ç‚¹å‡»ä¸Šä¼ åŒºåŸŸ
      uploadArea.addEventListener('click', function() {
        fileInput.click();
      });
      
      // æ–‡ä»¶é€‰æ‹©åå¤„ç†
      fileInput.addEventListener('change', function(e) {
        if (e.target.files.length > 0) {
          const file = e.target.files[0];
          handleFileUpload(file);
        }
      });
      
      // æ‹–æ‹½ä¸Šä¼ åŠŸèƒ½
      uploadArea.addEventListener('dragover', function(e) {
        e.preventDefault();
        uploadArea.classList.add('drag-over');
      });
      
      uploadArea.addEventListener('dragleave', function() {
        uploadArea.classList.remove('drag-over');
      });
      
      uploadArea.addEventListener('drop', function(e) {
        e.preventDefault();
        uploadArea.classList.remove('drag-over');
        
        if (e.dataTransfer.files.length > 0) {
          const file = e.dataTransfer.files[0];
          if (file.name.endsWith('.xlsx') || file.name.endsWith('.xls') || file.name.endsWith('.csv')) {
            handleFileUpload(file);
          } else {
            showStatus('è¯·é€‰æ‹©Excelæ–‡ä»¶ï¼', 'error');
          }
        }
      });
      
      // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
      function handleFileUpload(file) {
        // æ£€æŸ¥æ–‡ä»¶ç±»å‹
        if (!(file.name.endsWith('.xlsx') || file.name.endsWith('.xls') || file.name.endsWith('.csv'))) {
          showStatus('è¯·é€‰æ‹©Excelæ–‡ä»¶ï¼', 'error');
          return;
        }
        
        // æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆé™åˆ¶ä¸º10MBä»¥å†…ï¼‰
        if (file.size > 10 * 1024 * 1024) {
          showStatus('æ–‡ä»¶è¿‡å¤§ï¼Œè¯·é€‰æ‹©å°äº10MBçš„Excelæ–‡ä»¶ï¼', 'error');
          return;
        }
        
        uploadedFile = file;
        
        // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
        showStatus(`æ–‡ä»¶å: ${file.name}<br>æ–‡ä»¶å¤§å°: ${(file.size / (1024 * 1024)).toFixed(2)} MB<br>æ–‡ä»¶ç±»å‹: ${file.type || 'Excelæ–‡ä»¶'}`, 'info');
        
        // æ¨¡æ‹Ÿä¸Šä¼ è¿‡ç¨‹
        simulateUpload(file);
      }
      
      // æ¨¡æ‹Ÿä¸Šä¼ è¿‡ç¨‹
      function simulateUpload(file) {
        showStatus('æ­£åœ¨ä¸Šä¼ æ–‡ä»¶...', 'uploading');
        
        // æ¨¡æ‹Ÿä¸Šä¼ è¿›åº¦
        setTimeout(() => {
          showStatus(`æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼<br>æ–‡ä»¶å: ${file.name}<br>æ–‡ä»¶å¤§å°: ${(file.size / (1024 * 1024)).toFixed(2)} MB`, 'success');
          downloadBtn.disabled = false;
          
          // æ¨¡æ‹ŸåŠ è½½çƒ­åŠ›å›¾
          loadHeatmap();
        }, 2000);
      }
      
      // æ˜¾ç¤ºçŠ¶æ€ä¿¡æ¯
      function showStatus(message, status) {
        uploadStatus.innerHTML = `<p class="${status}">${message}</p>`;
        uploadStatus.className = 'upload-status ' + status;
      }
      
      // æ¨¡æ‹ŸåŠ è½½çƒ­åŠ›å›¾
      function loadHeatmap() {
        const heatmapPlaceholder = document.querySelector('.heatmap-placeholder');
        heatmapPlaceholder.innerHTML = `
          <img src="https://picsum.photos/800/500?random=2" alt="çƒ­åŠ›å›¾">
          <p>çƒ­åŠ›å›¾å·²ç”Ÿæˆ</p>
        `;
      }
      
      // ä¸‹è½½æŒ‰é’®äº‹ä»¶
      downloadBtn.addEventListener('click', function() {
        if (uploadedFile) {
          // æ¨¡æ‹Ÿä¸‹è½½
          showStatus('æ­£åœ¨å‡†å¤‡ä¸‹è½½çƒ­åŠ›å›¾...', 'info');
          setTimeout(() => {
            showStatus('çƒ­åŠ›å›¾ä¸‹è½½å®Œæˆï¼', 'success');
          }, 1000);
        }
      });
    });
  </script>
</body>
</html>